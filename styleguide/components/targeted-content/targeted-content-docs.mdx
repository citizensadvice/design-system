import { Story, Preview } from '@storybook/addon-docs/blocks';

# Targeted content

The targeted content component allows users to show and hide sections of related content on a page. It can help users scan and process content on a page more effectively.

However, it does hide content from users and it can be easy for users to miss. When using it, you should aim to use **no more than 6** and you shouldn’t have a targeted content on its own.

Because targeted contents hide content, they should always have a clear label/title that helps users understand what is in the section. You can use `h3` within them to break up the content.

## When to use

When content is only relevant to some particular users visiting the page.

## When not to use

They shouldn’t be used to make a page seem shorter, for example: using them to hide large chunks of content.
If you find yourself using targeted content to do this, think about:

- If you’re repeating content on the page and could consolidate it.
- Using headings on the page instead.
- If you need to move some of the content onto another page.

## Default behaviour

<Preview>
  <Story id="components-targeted-content--default" />
</Preview>

## Open targeted content with anchor

<Preview>
  <Story id="components-targeted-content--with-anchor" />
</Preview>

## Fallback behaviour

If JavaScript either fails or is disabled in the users browser the fallback is to show the content as open.

<Preview>
  <Story id="components-targeted-content--fallback" />
</Preview>

## Adviser variant

<Preview>
  <Story id="components-targeted-content--adviser" />
</Preview>

## JavaScript behaviour

Targeted content requires some additional JavaScript behaviour which can be initialised with:

```js
import initTargetedContent from '@citizensadvice/design-system/lib/targeted-content';
initTargetedContent();
```

**Note**: If you are supporting IE 11 or earlier make sure you include an [Element.prototype.closest polyfill](https://www.npmjs.com/package/element-closest).

## Using with Rails

If you are using the `citizens_advice_components` gem you call the component from within a template using:

```rb
= render(CitizensAdviceComponents::TargetedContent.new(title: "Your title",
  id: "targeted-content-example-id")) do
  %p Your HTML content
```

### Component arguments

The component accepts a [`content` block](https://viewcomponent.org/guide/#implementation) for the main contents along with the following arguments:

| Argument        | Description                                                              |
| --------------- | ------------------------------------------------------------------------ |
| `id`            | Required, unique ID                                                      |
| `title`         | Required, title string                                                   |
| `type`          | Optional, one of `public` or `adviser`. Defaults to `public`             |
| `heading_level` | Optional, sets the heading level of the title. Defaults to `2`           |
| `close_button`  | Optional, include close button at the end of content. Defaults to `true` |

### Haml template options

The haml partial takes a `targeted_content` hash with the following properties:

| properties      | Description                                                              |
| --------------- | ------------------------------------------------------------------------ |
| `id`            | Required, unique ID                                                      |
| `title`         | Required, title string                                                   |
| `body`          | Required, body HTML                                                      |
| `type`          | Optional, one of `public` or `adviser`. Defaults to `public`             |
| `heading_level` | Optional, sets the heading level of the title. Defaults to `2`           |
| `close_button`  | Optional, include close button at the end of content. Defaults to `true` |
